<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/vite.svg" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Vite + TS</title>
        <style>
            #\@editor {
                min-width: 300px;
                min-height: 200px;
                /* 필요에 따라 width, height 등도 함께 설정 */
            }
        </style>
    </head>
    <body>
        <div id="app">
            <div style="height: 500px;">
                <h1>Vite + TypeScript</h1>
                <div id="@editor"></div>
                <p id="@selection">Selection</p>
                <textarea id="@element" style="width: 100%; height: 100%;"></textarea>
            </div>
        </div>
        <script type="module" src="/src/main.ts"></script>
        <script>
            const observer = new MutationObserver((mutations) => {
                const elementTextarea = document.getElementById("@element");
                mutations.forEach((mutation) => {
                    if (mutation.type === "childList") {
                        // 요소가 새로 추가됨
                        
                        mutation.addedNodes.forEach((node) => {
                            if (node.nodeType === Node.ELEMENT_NODE) {
                                elementTextarea.value = '추가된       요소: ' + node.outerHTML + '\n' + elementTextarea.value;
                            } else if (node.nodeType === Node.TEXT_NODE) {
                                elementTextarea.value = '추가된 텍스트 노드: ' + node.textContent + '\n' + elementTextarea.value;
                            }
                        });

                        // 요소가 제거됨
                        mutation.removedNodes.forEach((node) => {
                            if (node.nodeType === Node.ELEMENT_NODE) {
                                elementTextarea.value = '제거된       요소: ' + node.outerHTML + '\n' + elementTextarea.value;
                            } else if (node.nodeType === Node.TEXT_NODE) {
                                elementTextarea.value = '제거된 텍스트 노드: ' + node.textContent + '\n' + elementTextarea.value;
                            }
                        });
                    }
                });
                elementTextarea.value = '============================' + '\n' + elementTextarea.value + '\n';
            });

            // body와 그 하위 요소들의 childList 변경을 감시
            observer.observe(document.getElementById("@editor"), {
                childList: true,
                subtree: true,
            });
        </script>
    </body>
</html>
